<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Rotaci√≥n de Turnos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="styles.css">
    <style>
        .configuracion-grupos {
            max-width: 100%;
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f8f9fa;
        }
        .grupo-editable {
            border-left: 4px solid;
            padding: 15px;
            margin: 15px 0;
            background: white;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .grupo-editable input {
            margin: 5px;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: calc(100% - 20px);
        }
        .grupo-editable button {
            margin: 5px;
            padding: 6px 12px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .botones-container {
            margin-top: 20px;
            text-align: center;
        }
        .botones-container button {
            margin: 5px;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .btn-guardar { background: #28a745; color: white; }
        .btn-agregar { background: #007bff; color: white; }
        .btn-reiniciar { background: #ffc107; color: black; }
        
        /* Ocultar secciones por defecto */
        #vistaGestionGrupos {
            display: none;
        }
        
        /* Alineaci√≥n de botones en el header */
        .header-buttons {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
            flex-wrap: wrap;
        }
        
        /* Colores din√°micos para las tarjetas de grupos */
        .grupo-card {
            border-left: 4px solid;
            transition: all 0.3s ease;
        }
        
        /* Leyenda con colores din√°micos */
        .legend-color-dinamico {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 3px;
            margin-right: 5px;
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <div class="row align-items-center">
    <div class="col-md-8">
        <h1><i class="fas fa-calendar-alt me-2"></i>Sistema de Rotaci√≥n de Turnos</h1>
        <p class="mb-0">Visualizaci√≥n de turnos por mes y a√±o completo</p>
    </div>
    <div class="header-buttons">
    <!-- Botones existentes -->
    <button class="btn btn-light no-print" onclick="imprimirTabla()">
        <i class="fas fa-print me-1"></i> Imprimir
    </button>
    
    <button class="btn btn-info no-print" onclick="mostrarGestionGrupos()">
        <i class="fas fa-users-cog me-1"></i> Gestionar Grupos
    </button>
    
    <!-- NUEVO BOT√ìN -->
    <button class="btn btn-warning no-print" onclick="mostrarVistaCalculos()">
    <i class="fas fa-calculator me-1"></i> C√°lculos
</button>
    
    <button class="btn btn-outline-light no-print" onclick="toggleModoOscuro()">
        <i class="fas fa-moon me-1"></i> Modo
    </button>
    
    <button onclick="exportarAExcel()" class="btn btn-success no-print">
        <i class="fas fa-file-excel me-1"></i> Excel
    </button>
</div>
</div>

<style>
.header-buttons {
    display: flex;
    gap: 8px;
    justify-content: flex-end;
    flex-wrap: wrap;
}

.header-buttons .btn {
    white-space: nowrap;
    flex-shrink: 0;
}
</style>
        </div>
    </div>

    <div class="container">
        <!-- VISTA PRINCIPAL (Turnos) -->
        <div id="vistaPrincipal">
            <div class="card no-print">
                <div class="card-header">
                    <i class="fas fa-cogs me-2"></i>Configuraci√≥n de Visualizaci√≥n
                </div>
                <div class="card-body">
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label for="vistaSeleccionada" class="form-label">Tipo de Vista</label>
                            <select id="vistaSeleccionada" class="form-select" onchange="cambiarVista()">
                                <option value="mes">Vista Mensual</option>
                                <option value="anio">Vista Anual</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label for="anioSeleccionado" class="form-label">A√±o</label>
                            <select id="anioSeleccionado" class="form-select" onchange="generarTabla()">
                                <!-- Opciones se llenan din√°micamente -->
                            </select>
                        </div>
                        <div class="col-md-4" id="mesSelectorContainer">
                            <label for="mesSeleccionado" class="form-label">Mes</label>
                            <select id="mesSeleccionado" class="form-select" onchange="generarTabla()">
                                <option value="1">Enero</option>
                                <option value="2">Febrero</option>
                                <option value="3">Marzo</option>
                                <option value="4">Abril</option>
                                <option value="5">Mayo</option>
                                <option value="6">Junio</option>
                                <option value="7">Julio</option>
                                <option value="8">Agosto</option>
                                <option value="9">Septiembre</option>
                                <option value="10">Octubre</option>
                                <option value="11">Noviembre</option>
                                <option value="12">Diciembre</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-12">
                            <div class="legend" id="leyenda-grupos">
                                <strong>Leyenda de Grupos:</strong>
                                <!-- Se generar√° din√°micamente desde JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <span id="tituloMes"><i class="fas fa-calendar me-2"></i>Cargando...</span>
                    <span class="contador-info" id="contadorInfo"></span>
                </div>
                <div class="card-body p-0">
                    <div id="tablaTurnosContainer">
                        <!-- Aqu√≠ se generar√° la tabla din√°micamente -->
                    </div>
                </div>
            </div>
            
            <div class="card no-print">
                <div class="card-header">
                    <i class="fas fa-users me-2"></i>Informaci√≥n de Grupos
                </div>
                <div class="card-body">
                    <div class="row" id="info-grupos-container">
                        <!-- Se generar√° din√°micamente desde JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- VISTA GESTI√ìN DE GRUPOS -->
        <!-- VISTA GESTI√ìN DE GRUPOS -->
<div id="vistaGestionGrupos">
    <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
            <span><i class="fas fa-users-cog me-2"></i>Gesti√≥n de Grupos</span>
            <button class="btn btn-secondary" onclick="mostrarVistaPrincipal()">
                <i class="fas fa-arrow-left me-1"></i> Volver a Turnos
            </button>
        </div>
        <div class="card-body">
            <!-- Panel de Acceso Admin -->
            <div id="panelAccesoAdmin" class="text-center mb-4 p-4 border rounded">
                <h5><i class="fas fa-lock me-2"></i>Acceso Administrativo</h5>
                <p class="text-muted">Ingrese la contrase√±a para gestionar los grupos</p>
                <div class="row justify-content-center">
                    <div class="col-md-6">
                        <div class="input-group">
                            <input type="password" id="inputPasswordAdmin" class="form-control" 
                                   placeholder="Contrase√±a de administrador">
                            <button class="btn btn-primary" onclick="verificarAccesoAdmin()">
                                <i class="fas fa-key me-1"></i> Acceder
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Panel de Gesti√≥n (oculto inicialmente) -->
            <div id="panelGestionGrupos" style="display: none;">
                <div class="configuracion-grupos">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Modo Administrador</strong> - Aqu√≠ puedes modificar los grupos, cambiar integrantes, colores y agregar nuevos grupos.
                    </div>
                    
                    <div id="grupos-container">
                        <!-- Los grupos se generar√°n din√°micamente aqu√≠ -->
                    </div>
                    
                    <div class="botones-container">
                        <button class="btn-agregar" onclick="agregarNuevoGrupo()">
                            <i class="fas fa-plus me-1"></i>Agregar Grupo
                        </button>
                        <button class="btn-guardar" onclick="guardarCambiosGrupos()">
                            <i class="fas fa-save me-1"></i>Guardar Cambios
                        </button>
                        <button class="btn-reiniciar" onclick="reiniciarGrupos()">
                            <i class="fas fa-undo me-1"></i>Reiniciar a Valores por Defecto
                        </button>
                        <button class="btn btn-outline-secondary" onclick="cerrarSesionAdmin()">
                            <i class="fas fa-sign-out-alt me-1"></i>Cerrar Sesi√≥n
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- VISTA C√ÅLCULOS -->
<div id="vistaCalculos" style="display: none;">
    <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
            <span><i class="fas fa-calculator me-2"></i>Calculadora de Turnos</span>
            <button class="btn btn-secondary" onclick="mostrarVistaPrincipal()">
                <i class="fas fa-arrow-left me-1"></i> Volver a Turnos
            </button>
        </div>
        <div class="card-body">
            <div class="alert alert-info">
                <i class="fas fa-info-circle me-2"></i>
                Calcula bonos nocturnos y domingos trabajados por grupo en un rango de fechas.
            </div>
            
            <div class="row mb-4">
                <div class="col-md-4">
                    <label for="fechaInicioCalculos" class="form-label">Fecha Inicio</label>
                    <input type="date" id="fechaInicioCalculos" class="form-control">
                </div>
                <div class="col-md-4">
                    <label for="fechaFinCalculos" class="form-label">Fecha Fin</label>
                    <input type="date" id="fechaFinCalculos" class="form-control">
                </div>
                <div class="col-md-4">
                    <label class="form-label">&nbsp;</label>
                    <button class="btn btn-primary w-100" onclick="generarReporteTurnos()">
                        <i class="fas fa-calculator me-1"></i> Calcular Reporte
                    </button>
                </div>
            </div>
            
            <div id="reporteTurnos">
                <!-- Aqu√≠ se mostrar√°n los resultados -->
                <div class="text-center text-muted p-4">
                    <i class="fas fa-calculator fa-3x mb-3"></i>
                    <p>Selecciona un rango de fechas y haz clic en "Calcular Reporte"</p>
                </div>
            </div>
        </div>
    </div>
</div>

        
        <!-- Etiqueta del nombre para impresi√≥n -->
        <div class="etiqueta-nombre">
            <p class="mb-0">Ing. Miguel J. Gonzalez M.</p>
        </div>
    </div>

    <script src="turnos-system.js"></script>
	
	

<script src="turnos-system.js"></script>

<script>
//************************************************
</script>

<script src="turnos-system.js"></script>

<script src="turnos-system.js"></script>

<script>
// === CLASE CALCULADORTURNOS CON LA MISMA ESTRUCTURA QUE TU SISTEMA ===
class CalculadorTurnos {
    constructor() {
        this.fechaInicio = new Date(2000, 0, 14); // 14/01/2000
        this.cicloRotacion = 24;
        
        this.Turno = {
            MANANA: { 
                horario: "6:00-14:30", 
                nombre: "Ma√±ana", 
                abrev: "M"
            },
            TARDE: { 
                horario: "14:30-22:30", 
                nombre: "Tarde", 
                abrev: "T"
            },
            NOCHE: { 
                horario: "22:30-6:00", 
                nombre: "Noche", 
                abrev: "N"
            },
            LIBRE: { 
                horario: "Libre", 
                nombre: "Libre", 
                abrev: "-"
            }
        };

        this.patronTurnos = this.generarPatronTurnos();
    }

    generarPatronTurnos() {
        const patron = {};
        
        const secuencias = {
            'A': [this.Turno.NOCHE, this.Turno.NOCHE, this.Turno.NOCHE, this.Turno.NOCHE, 
                  this.Turno.NOCHE, this.Turno.NOCHE, this.Turno.LIBRE, this.Turno.LIBRE,
                  this.Turno.TARDE, this.Turno.TARDE, this.Turno.TARDE, this.Turno.TARDE,
                  this.Turno.TARDE, this.Turno.TARDE, this.Turno.LIBRE, this.Turno.LIBRE,
                  this.Turno.MANANA, this.Turno.MANANA, this.Turno.MANANA, this.Turno.MANANA,
                  this.Turno.MANANA, this.Turno.MANANA, this.Turno.LIBRE, this.Turno.LIBRE],
            
            'B': [this.Turno.LIBRE, this.Turno.LIBRE, this.Turno.TARDE, this.Turno.TARDE,
                  this.Turno.TARDE, this.Turno.TARDE, this.Turno.TARDE, this.Turno.TARDE,
                  this.Turno.LIBRE, this.Turno.LIBRE, this.Turno.MANANA, this.Turno.MANANA,
                  this.Turno.MANANA, this.Turno.MANANA, this.Turno.MANANA, this.Turno.MANANA,
                  this.Turno.LIBRE, this.Turno.LIBRE, this.Turno.NOCHE, this.Turno.NOCHE,
                  this.Turno.NOCHE, this.Turno.NOCHE, this.Turno.NOCHE, this.Turno.NOCHE],
            
            'C': [this.Turno.TARDE, this.Turno.TARDE, this.Turno.LIBRE, this.Turno.LIBRE,
                  this.Turno.MANANA, this.Turno.MANANA, this.Turno.MANANA, this.Turno.MANANA,
                  this.Turno.MANANA, this.Turno.MANANA, this.Turno.LIBRE, this.Turno.LIBRE,
                  this.Turno.NOCHE, this.Turno.NOCHE, this.Turno.NOCHE, this.Turno.NOCHE,
                  this.Turno.NOCHE, this.Turno.NOCHE, this.Turno.LIBRE, this.Turno.LIBRE,
                  this.Turno.TARDE, this.Turno.TARDE, this.Turno.TARDE, this.Turno.TARDE],
            
            'D': [this.Turno.MANANA, this.Turno.MANANA, this.Turno.MANANA, this.Turno.MANANA,
                  this.Turno.LIBRE, this.Turno.LIBRE, this.Turno.NOCHE, this.Turno.NOCHE,
                  this.Turno.NOCHE, this.Turno.NOCHE, this.Turno.NOCHE, this.Turno.NOCHE,
                  this.Turno.LIBRE, this.Turno.LIBRE, this.Turno.TARDE, this.Turno.TARDE,
                  this.Turno.TARDE, this.Turno.TARDE, this.Turno.TARDE, this.Turno.TARDE,
                  this.Turno.LIBRE, this.Turno.LIBRE, this.Turno.MANANA, this.Turno.MANANA]
        };

        for (let dia = 0; dia < this.cicloRotacion; dia++) {
            patron[dia] = {
                'A': secuencias['A'][dia],
                'B': secuencias['B'][dia],
                'C': secuencias['C'][dia],
                'D': secuencias['D'][dia]
            };
        }

        return patron;
    }

    // === M√âTODO PARA CALCULAR D√çAS DESDE INICIO ===
    calcularDiasDesdeInicio(fecha) {
    const unDia = 24 * 60 * 60 * 1000;
        const diferencia = fecha.getTime() - this.fechaInicio.getTime();
        return Math.floor(diferencia / unDia);
}

    // === M√âTODO PARA OBTENER TURNOS DE UNA FECHA ===
   obtenerTurnosParaFecha(fecha) {
    const diasDesdeInicio = this.calcularDiasDesdeInicio(fecha);
	//alert("dias:" + diasDesdeInicio);
    const diaCiclo = ((diasDesdeInicio % this.cicloRotacion) + this.cicloRotacion) % this.cicloRotacion;
    
    return this.patronTurnos[diaCiclo];
}

obtenerGrupoPorTurno(fecha, tipoTurno) {
    // Usar el nuevo m√©todo obtenerTurnosParaFecha
    const turnosDelDia = this.obtenerTurnosParaFecha(fecha);
    
    // Buscar qu√© grupo tiene el turno solicitado
    for (const grupoKey of Object.keys(this.Grupo)) {
        const turno = turnosDelDia[grupoKey];
        if (turno.nombre === this.Turno[tipoTurno].nombre) {
            return grupoKey;
        }
    }
    return null;
}

    // === M√âTODO PRINCIPAL PARA CALCULAR TURNOS ===
    calcularTurnos(fechaInicioConsulta, fechaFinConsulta) {
        const resultados = {
            bonosNocturnos: [0, 0, 0, 0], // A, B, C, D
            domingosGrupoA: [0, 0, 0], // [MANANA, TARDE, NOCHE]
            domingosGrupoB: [0, 0, 0],
            domingosGrupoC: [0, 0, 0],
            domingosGrupoD: [0, 0, 0],
            totalDomingosPeriodo: 0
        };

        const totalDias = this.diferenciaDias(fechaInicioConsulta, fechaFinConsulta);
        let fechaActual = new Date(fechaInicioConsulta);
		
		fechaActual.setDate(fechaActual.getDate() + 1);
		//alert("SI:" + totalDias);
		//alert("SI:" + fechaActual);
        //console.log(`üîç Calculando desde ${fechaActual.toLocaleDateString()} hasta ${fechaFinConsulta.toLocaleDateString()}`);
        //console.log(`üìÖ Total de d√≠as: ${totalDias + 1}`);

        for (let dia = 0; dia <= totalDias; dia++) {
            if (dia > 0) {
                fechaActual.setDate(fechaActual.getDate() + 1);
            }
            
			//alert("SI" + fechaActual);
            const turnos = this.obtenerTurnosParaFecha(fechaActual);
            const diasDesdeInicio = this.calcularDiasDesdeInicio(fechaActual);
            const diaCiclo = ((diasDesdeInicio % this.cicloRotacion) + this.cicloRotacion) % this.cicloRotacion;

            // DEBUG: Mostrar cada d√≠a
            if (dia % 7 === 0 || dia === totalDias) {
			
                console.log(`${fechaActual.toLocaleDateString()} - D√≠a ${diaCiclo}: A=${turnos.A.abrev} B=${turnos.B.abrev} C=${turnos.C.abrev} D=${turnos.D.abrev}`);
            }
			//alert("Fecha:" + fechaActual);
            // Contar domingos
            const esDomingo = fechaActual.getDay() === 0;
            if (esDomingo) {
                resultados.totalDomingosPeriodo++;
            }

            // Calcular bonos y domingos por grupo
            this.calcularEstadisticasParaDia(fechaActual, turnos, resultados, esDomingo);
        }

        // Calcular totales de domingos
        resultados.totalDomingosGrupoA = resultados.domingosGrupoA.reduce((a, b) => a + b, 0);
        resultados.totalDomingosGrupoB = resultados.domingosGrupoB.reduce((a, b) => a + b, 0);
        resultados.totalDomingosGrupoC = resultados.domingosGrupoC.reduce((a, b) => a + b, 0);
        resultados.totalDomingosGrupoD = resultados.domingosGrupoD.reduce((a, b) => a + b, 0);

        return resultados;
    }

    calcularEstadisticasParaDia(fecha, turnos, resultados, esDomingo) {
        // Grupo A
        if (turnos.A.horario === "14:30-22:30") {
            resultados.bonosNocturnos[0] += 2.5;
        } else if (turnos.A.horario === "22:30-6:00") {
            resultados.bonosNocturnos[0] += 7.5;
        }
        
        if (esDomingo && turnos.A.horario !== "Libre") {
            if (turnos.A.horario === "6:00-14:30") resultados.domingosGrupoA[0]++;
            else if (turnos.A.horario === "14:30-22:30") resultados.domingosGrupoA[1]++;
            else if (turnos.A.horario === "22:30-6:00") resultados.domingosGrupoA[2]++;
        }

        // Grupo B
        if (turnos.B.horario === "14:30-22:30") {
            resultados.bonosNocturnos[1] += 2.5;
        } else if (turnos.B.horario === "22:30-6:00") {
            resultados.bonosNocturnos[1] += 7.5;
        }
        
        if (esDomingo && turnos.B.horario !== "Libre") {
            if (turnos.B.horario === "6:00-14:30") resultados.domingosGrupoB[0]++;
            else if (turnos.B.horario === "14:30-22:30") resultados.domingosGrupoB[1]++;
            else if (turnos.B.horario === "22:30-6:00") resultados.domingosGrupoB[2]++;
        }

        // Grupo C
        if (turnos.C.horario === "14:30-22:30") {
            resultados.bonosNocturnos[2] += 2.5;
        } else if (turnos.C.horario === "22:30-6:00") {
            resultados.bonosNocturnos[2] += 7.5;
        }
        
        if (esDomingo && turnos.C.horario !== "Libre") {
            if (turnos.C.horario === "6:00-14:30") resultados.domingosGrupoC[0]++;
            else if (turnos.C.horario === "14:30-22:30") resultados.domingosGrupoC[1]++;
            else if (turnos.C.horario === "22:30-6:00") resultados.domingosGrupoC[2]++;
        }

        // Grupo D
        if (turnos.D.horario === "14:30-22:30") {
            resultados.bonosNocturnos[3] += 2.5;
        } else if (turnos.D.horario === "22:30-6:00") {
            resultados.bonosNocturnos[3] += 7.5;
        }
        
        if (esDomingo && turnos.D.horario !== "Libre") {
            if (turnos.D.horario === "6:00-14:30") resultados.domingosGrupoD[0]++;
            else if (turnos.D.horario === "14:30-22:30") resultados.domingosGrupoD[1]++;
            else if (turnos.D.horario === "22:30-6:00") resultados.domingosGrupoD[2]++;
        }
    }

    diferenciaDias(fecha1, fecha2) {
        const unDia = 24 * 60 * 60 * 1000;
        const diferencia = fecha2.getTime() - fecha1.getTime();
        return Math.floor(diferencia / unDia);
    }
}

// === PRUEBA CON LA ESTRUCTURA EXACTA ===


// Ejecutar prueba al cargar
document.addEventListener('DOMContentLoaded', function() {
    //console.log('‚úÖ CalculadorTurnos con estructura exacta');
    //console.log('========================================');
    
    setTimeout(pruebaConEstructuraExacta, 500);
});
</script>
<script>
//************************************************
</script>


<script>
// === SISTEMA COMPLETO DE NAVEGACI√ìN Y C√ÅLCULOS ===



// 5. FUNCI√ìN COMPLETA PARA GENERAR REPORTE
function generarReporteTurnos() {
    const fechaInicio = document.getElementById('fechaInicioCalculos').value;
    const fechaFin = document.getElementById('fechaFinCalculos').value;
    
    if (!fechaInicio || !fechaFin) {
        alert('‚ö†Ô∏è Por favor selecciona ambas fechas');
        return;
    }
    
    if (new Date(fechaInicio) > new Date(fechaFin)) {
        alert('‚ùå La fecha de inicio no puede ser mayor a la fecha fin');
        return;
    }
    
    // Usar el CalculadorTurnos que est√° en turnos-system.js
    try {
        const calculador = new CalculadorTurnos();
        const resultados = calculador.calcularTurnos(new Date(fechaInicio), new Date(fechaFin));
        mostrarResultadosEnWeb(resultados);
    } catch (error) {
        alert('‚ùå Error en los c√°lculos: ' + error.message);
        console.error(error);
    }
}

// 6. FUNCI√ìN PARA MOSTRAR RESULTADOS EN LA P√ÅGINA
function mostrarResultadosEnWeb(resultados) {
    const contenedor = document.getElementById('reporteTurnos');
    
    const html = `
        <div class="card mt-4">
            <div class="card-header bg-success text-white">
                <h4 class="mb-0"><i class="fas fa-chart-bar me-2"></i>Reporte de Turnos</h4>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered">
                        <thead class="table-dark">
                            <tr>
                                <th>Grupo</th>
                                <th>Bono Nocturno (hrs)</th>
                                <th>Dom 6:00-14:30</th>
                                <th>Dom 14:30-22:30</th>
                                <th>Dom 22:30-6:00</th>
                                <th>Total Domingos</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Grupo A</strong></td>
                                <td>${resultados.bonosNocturnos[0].toFixed(1)}</td>
                                <td>${resultados.domingosGrupoA[0]}</td>
                                <td>${resultados.domingosGrupoA[1]}</td>
                                <td>${resultados.domingosGrupoA[2]}</td>
                                <td><strong>${resultados.totalDomingosGrupoA}</strong></td>
                            </tr>
                            <tr>
                                <td><strong>Grupo B</strong></td>
                                <td>${resultados.bonosNocturnos[1].toFixed(1)}</td>
                                <td>${resultados.domingosGrupoB[0]}</td>
                                <td>${resultados.domingosGrupoB[1]}</td>
                                <td>${resultados.domingosGrupoB[2]}</td>
                                <td><strong>${resultados.totalDomingosGrupoB}</strong></td>
                            </tr>
                            <tr>
                                <td><strong>Grupo C</strong></td>
                                <td>${resultados.bonosNocturnos[2].toFixed(1)}</td>
                                <td>${resultados.domingosGrupoC[0]}</td>
                                <td>${resultados.domingosGrupoC[1]}</td>
                                <td>${resultados.domingosGrupoC[2]}</td>
                                <td><strong>${resultados.totalDomingosGrupoC}</strong></td>
                            </tr>
                            <tr>
                                <td><strong>Grupo D</strong></td>
                                <td>${resultados.bonosNocturnos[3].toFixed(1)}</td>
                                <td>${resultados.domingosGrupoD[0]}</td>
                                <td>${resultados.domingosGrupoD[1]}</td>
                                <td>${resultados.domingosGrupoD[2]}</td>
                                <td><strong>${resultados.totalDomingosGrupoD}</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="alert alert-info mt-3">
                    <strong>Total domingos en el per√≠odo:</strong> ${resultados.totalDomingosPeriodo}
                </div>
                <button class="btn btn-secondary no-print" onclick="imprimirReporte()">
                    <i class="fas fa-print me-1"></i> Imprimir Reporte
                </button>
            </div>
        </div>
    `;
    
    contenedor.innerHTML = html;
}

// 7. Funci√≥n para imprimir reporte
function imprimirReporte() {
    window.print();
}

// 8. Verificar que todas las vistas existan al cargar la p√°gina
document.addEventListener('DOMContentLoaded', function() {
    console.log('=== VERIFICANDO VISTAS ===');
    console.log('vistaPrincipal:', document.getElementById('vistaPrincipal'));
    console.log('vistaGestionGrupos:', document.getElementById('vistaGestionGrupos'));
    console.log('vistaCalculos:', document.getElementById('vistaCalculos'));
    
    // Asegurar que solo la vista principal est√© visible al inicio
    document.getElementById('vistaPrincipal').style.display = 'block';
    document.getElementById('vistaGestionGrupos').style.display = 'none';
    document.getElementById('vistaCalculos').style.display = 'none';
    
    // Verificar que CalculadorTurnos est√© disponible
    console.log('CalculadorTurnos disponible:', typeof CalculadorTurnos);
});
</script>
<script>
    // Verificar qu√© funciones est√°n disponibles
    //console.log('=== VERIFICACI√ìN DE FUNCIONES ===');
    //console.log('mostrarVistaCalculos:', typeof mostrarVistaCalculos);
    //console.log('generarReporteTurnos:', typeof generarReporteTurnos);
    //console.log('CalculadorTurnos:', typeof CalculadorTurnos);
    
    // Si no est√°n disponibles, forzar la asignaci√≥n
    if (typeof mostrarVistaCalculos === 'undefined') {
        //console.log('‚ö†Ô∏è Funciones no disponibles - asignando manualmente');
        // Aqu√≠ copia y pega las funciones directamente
    }
</script>
	
	
	
    <script>
	
	// Configuraci√≥n de administrador
const ADMIN_CONFIG = {
    password: "admin123", // Puedes cambiar esta contrase√±a
    sessionTimeout: 30 * 60 * 1000, // 30 minutos
    sessionKey: "adminSession"
};

// Estado de autenticaci√≥n
let isAdminAuthenticated = false;

// Funci√≥n para verificar acceso admin
function verificarAccesoAdmin() {
    const passwordInput = document.getElementById('inputPasswordAdmin');
    const password = passwordInput.value.trim();
    
    if (password === ADMIN_CONFIG.password) {
        // Acceso concedido
        isAdminAuthenticated = true;
        mostrarPanelGestion();
        iniciarSesionAdmin();
        passwordInput.value = ''; // Limpiar campo
    } else {
        // Acceso denegado
        alert('‚ùå Contrase√±a incorrecta. Intente nuevamente.');
        passwordInput.value = '';
        passwordInput.focus();
    }
}

// Funci√≥n para mostrar el panel de gesti√≥n
function mostrarPanelGestion() {
    document.getElementById('panelAccesoAdmin').style.display = 'none';
    document.getElementById('panelGestionGrupos').style.display = 'block';
    mostrarInterfazGrupos(); // Cargar la interfaz de grupos
}

// Funci√≥n para ocultar el panel de gesti√≥n
function ocultarPanelGestion() {
    document.getElementById('panelAccesoAdmin').style.display = 'block';
    document.getElementById('panelGestionGrupos').style.display = 'none';
    isAdminAuthenticated = false;
}

// Funci√≥n para iniciar sesi√≥n admin
function iniciarSesionAdmin() {
    const sessionData = {
        timestamp: new Date().getTime(),
        authenticated: true
    };
    localStorage.setItem(ADMIN_CONFIG.sessionKey, JSON.stringify(sessionData));
}

// Funci√≥n para verificar sesi√≥n activa
function verificarSesionActiva() {
    const sessionData = localStorage.getItem(ADMIN_CONFIG.sessionKey);
    if (sessionData) {
        const data = JSON.parse(sessionData);
        const now = new Date().getTime();
        
        if (now - data.timestamp < ADMIN_CONFIG.sessionTimeout) {
            isAdminAuthenticated = true;
            return true;
        } else {
            // Sesi√≥n expirada
            localStorage.removeItem(ADMIN_CONFIG.sessionKey);
        }
    }
    return false;
}

// Funci√≥n para cerrar sesi√≥n admin
function cerrarSesionAdmin() {
    isAdminAuthenticated = false;
    localStorage.removeItem(ADMIN_CONFIG.sessionKey);
    ocultarPanelGestion();
    alert('üîí Sesi√≥n de administrador cerrada.');
}

// Modificar la funci√≥n mostrarGestionGrupos
function mostrarGestionGrupos() {
    document.getElementById('vistaPrincipal').style.display = 'none';
    document.getElementById('vistaGestionGrupos').style.display = 'block';
    
    // Verificar si ya hay sesi√≥n activa
    if (verificarSesionActiva()) {
        mostrarPanelGestion();
    } else {
        ocultarPanelGestion();
    }
}

// Modificar la funci√≥n mostrarInterfazGrupos para quitar botones de eliminar
function mostrarInterfazGrupos() {
    const container = document.getElementById('grupos-container');
    container.innerHTML = '';
    
    Object.keys(Grupo).forEach(grupoKey => {
        const grupo = Grupo[grupoKey];
        container.innerHTML += `
            <div class="grupo-editable" style="border-left-color: ${grupo.color}">
                <h5>Grupo ${grupoKey}</h5>
                <label>Integrantes:</label>
                <input type="text" value="${grupo.integrantes}" 
                       onchange="actualizarGrupo('${grupoKey}', 'integrantes', this.value)"
                       placeholder="Integrantes del grupo">
                <label>Color:</label>
                <input type="color" value="${grupo.color}" 
                       onchange="actualizarGrupo('${grupoKey}', 'color', this.value)">
                <!-- Bot√≥n de eliminar REMOVIDO -->
            </div>
        `;
    });
}

// Modificar la funci√≥n agregarNuevoGrupo para verificar permisos
function agregarNuevoGrupo() {
    if (!isAdminAuthenticated) {
        alert('üîí Acceso denegado. Debe iniciar sesi√≥n como administrador.');
        return;
    }
    
    const nuevoKey = prompt("Ingresa la letra del nuevo grupo (E, F, G, etc.):");
    if (nuevoKey && nuevoKey.trim() !== "") {
        const key = nuevoKey.trim().toUpperCase();
        if (!Grupo[key]) {
            Grupo[key] = {
                grupo: key,
                integrantes: "Nuevo integrante 1 - Nuevo integrante 2",
                clase: `grupo-${key}`,
                color: "#" + Math.floor(Math.random()*16777215).toString(16).padStart(6, '0')
            };
            mostrarInterfazGrupos();
        } else {
            alert(`El grupo ${key} ya existe.`);
        }
    }
}

// Modificar la funci√≥n reiniciarGrupos para verificar permisos
function reiniciarGrupos() {
    if (!isAdminAuthenticated) {
        alert('üîí Acceso denegado. Debe iniciar sesi√≥n como administrador.');
        return;
    }
    
    if (confirm('¬øRestaurar grupos a valores por defecto? Se perder√°n los cambios no guardados.')) {
        Grupo = {
            A: { 
                grupo: "A", 
                integrantes: "Juan Cachope - Tiago Santana", 
                clase: "grupo-A",
                color: "#e3f2fd"
            },
            B: { 
                grupo: "B", 
                integrantes: "Alvaro Aguilar - Arnaldo Larroza", 
                clase: "grupo-B",
                color: "#e8f5e9"
            },
            C: { 
                grupo: "C", 
                integrantes: "Lisandro Centurion - Abel Salinas", 
                clase: "grupo-C",
                color: "#fff3e0"
            },
            D: { 
                grupo: "D", 
                integrantes: "Miguel Gonzalez - Patricio Fernandez", 
                clase: "grupo-D",
                color: "#fce4ec"
            }
        };
        localStorage.removeItem('gruposConfig');
        mostrarInterfazGrupos();
        alert('Grupos reiniciados a valores por defecto.');
    }
}

// Modificar la funci√≥n guardarCambiosGrupos para verificar permisos
function guardarCambiosGrupos() {
    if (!isAdminAuthenticated) {
        alert('üîí Acceso denegado. Debe iniciar sesi√≥n como administrador.');
        return;
    }
    
    try {
        localStorage.setItem('gruposConfig', JSON.stringify(Grupo));
        alert('‚úÖ Cambios guardados correctamente. Los grupos se mantendr√°n despu√©s de recargar la p√°gina.');
        
        actualizarInfoGrupos();
        actualizarLeyendaGrupos();
        actualizarEstilosGrupos();
        forzarActualizacionColores();
        
        // Volver a la vista principal
        setTimeout(() => {
            mostrarVistaPrincipal();
        }, 500);
        
    } catch (error) {
        alert('‚ùå Error al guardar los cambios: ' + error.message);
    }
}

// Cargar verificaci√≥n de sesi√≥n al iniciar
document.addEventListener('DOMContentLoaded', function() {
    cargarGruposGuardados();
    mostrarVistaPrincipal();
    verificarSesionActiva(); // Verificar sesi√≥n al cargar la p√°gina
});
        // Datos iniciales de grupos
        let Grupo = {
            A: { 
                grupo: "A", 
                integrantes: "Juan Cachope - Tiago Santana", 
                clase: "grupo-A",
                color: "#e3f2fd"
            },
            B: { 
                grupo: "B", 
                integrantes: "Alvaro Aguilar - Arnaldo Larroza", 
                clase: "grupo-B",
                color: "#e8f5e9"
            },
            C: { 
                grupo: "C", 
                integrantes: "Lisandro Centurion - Abel Salinas", 
                clase: "grupo-C",
                color: "#fff3e0"
            },
            D: { 
                grupo: "D", 
                integrantes: "Miguel Gonzalez - Patricio Fernandez", 
                clase: "grupo-D",
                color: "#fce4ec"
            }
        };

        // Funciones para cambiar entre vistas
        function mostrarVistaPrincipal() {
    document.getElementById('vistaPrincipal').style.display = 'block';
    document.getElementById('vistaGestionGrupos').style.display = 'none';
	document.getElementById('vistaCalculos').style.display = 'none';
    
    // Cerrar sesi√≥n admin autom√°ticamente al salir
    if (isAdminAuthenticated) {
        cerrarSesionAdmin();
    }
}
        function mostrarGestionGrupos() {
            document.getElementById('vistaPrincipal').style.display = 'none';
            document.getElementById('vistaGestionGrupos').style.display = 'block';
			document.getElementById('vistaCalculos').style.display = 'none';
            // Asegurarse de que la interfaz de grupos est√© actualizada
            mostrarInterfazGrupos();
        }
		
		// 1. Funci√≥n para mostrar vista de c√°lculos
		function mostrarVistaCalculos() {
			//console.log('‚úÖ Mostrando vista de c√°lculos');
			document.getElementById('vistaPrincipal').style.display = 'none';
			document.getElementById('vistaGestionGrupos').style.display = 'none';
			document.getElementById('vistaCalculos').style.display = 'block';
			
		}

        // Cargar grupos guardados al iniciar
        function cargarGruposGuardados() {
            const gruposGuardados = localStorage.getItem('gruposConfig');
            if (gruposGuardados) {
                Grupo = JSON.parse(gruposGuardados);
            }
            actualizarInfoGrupos();
            actualizarLeyendaGrupos();
        }

        // Mostrar interfaz de grupos
        function mostrarInterfazGrupos() {
            const container = document.getElementById('grupos-container');
            container.innerHTML = '';
            
            Object.keys(Grupo).forEach(grupoKey => {
                const grupo = Grupo[grupoKey];
                container.innerHTML += `
                    <div class="grupo-editable" style="border-left-color: ${grupo.color}">
                        <h5>Grupo ${grupoKey}</h5>
                        <label>Integrantes:</label>
                        <input type="text" value="${grupo.integrantes}" 
                               onchange="actualizarGrupo('${grupoKey}', 'integrantes', this.value)"
                               placeholder="Integrantes del grupo">
                        <label>Color:</label>
                        <input type="color" value="${grupo.color}" 
                               onchange="actualizarGrupo('${grupoKey}', 'color', this.value)">
                        <button onclick="eliminarGrupoUI('${grupoKey}')">
                            <i class="fas fa-trash me-1"></i>Eliminar Grupo
                        </button>
                    </div>
                `;
            });
        }

        // Actualizar un grupo
        function actualizarGrupo(grupoKey, campo, valor) {
            if (Grupo[grupoKey]) {
                Grupo[grupoKey][campo] = valor;
                // Actualizar visualmente el borde del color
                const elementos = document.querySelectorAll(`[style*="border-left-color:"]`);
                elementos.forEach(el => {
                    if (el.querySelector('h5').textContent === `Grupo ${grupoKey}`) {
                        el.style.borderLeftColor = campo === 'color' ? valor : Grupo[grupoKey].color;
                    }
                });
            }
        }

        // Agregar nuevo grupo
        function agregarNuevoGrupo() {
            const nuevoKey = prompt("Ingresa la letra del nuevo grupo (E, F, G, etc.):");
            if (nuevoKey && nuevoKey.trim() !== "") {
                const key = nuevoKey.trim().toUpperCase();
                if (!Grupo[key]) {
                    Grupo[key] = {
                        grupo: key,
                        integrantes: "Nuevo integrante 1 - Nuevo integrante 2",
                        clase: `grupo-${key}`,
                        color: "#" + Math.floor(Math.random()*16777215).toString(16).padStart(6, '0')
                    };
                    mostrarInterfazGrupos();
                } else {
                    alert(`El grupo ${key} ya existe.`);
                }
            }
        }

        // Eliminar grupo
        function eliminarGrupoUI(grupoKey) {
            if (Object.keys(Grupo).length <= 1) {
                alert("Debe haber al menos un grupo.");
                return;
            }
            
            if (confirm(`¬øEst√°s seguro de eliminar el Grupo ${grupoKey}?`)) {
                delete Grupo[grupoKey];
                mostrarInterfazGrupos();
            }
        }

        // Guardar cambios permanentemente
        function guardarCambiosGrupos() {
            try {
                localStorage.setItem('gruposConfig', JSON.stringify(Grupo));
                alert('‚úÖ Cambios guardados correctamente. Los grupos se mantendr√°n despu√©s de recargar la p√°gina.');
                console.log('Grupos guardados:', Grupo);
                actualizarInfoGrupos();
                actualizarLeyendaGrupos();
                // Recargar la tabla para aplicar cambios
                if (typeof generarTabla === 'function') {
                    generarTabla();
                }
                // Volver a la vista principal
                mostrarVistaPrincipal();
            } catch (error) {
                alert('‚ùå Error al guardar los cambios: ' + error.message);
            }
        }

        // Reiniciar grupos a valores por defecto
        function reiniciarGrupos() {
            if (confirm('¬øRestaurar grupos a valores por defecto? Se perder√°n los cambios no guardados.')) {
                Grupo = {
                    A: { 
                        grupo: "A", 
                        integrantes: "Juan Cachope - Tiago Santana", 
                        clase: "grupo-A",
                        color: "#e3f2fd"
                    },
                    B: { 
                        grupo: "B", 
                        integrantes: "Alvaro Aguilar - Arnaldo Larroza", 
                        clase: "grupo-B",
                        color: "#e8f5e9"
                    },
                    C: { 
                        grupo: "C", 
                        integrantes: "Lisandro Centurion - Abel Salinas", 
                        clase: "grupo-C",
                        color: "#fff3e0"
                    },
                    D: { 
                        grupo: "D", 
                        integrantes: "Miguel Gonzalez - Patricio Fernandez", 
                        clase: "grupo-D",
                        color: "#fce4ec"
                    }
                };
                localStorage.removeItem('gruposConfig');
                mostrarInterfazGrupos();
                alert('Grupos reiniciados a valores por defecto.');
            }
        }

        // Actualizar la informaci√≥n de grupos en la tarjeta - CORREGIDO
        function actualizarInfoGrupos() {
            const container = document.getElementById('info-grupos-container');
            container.innerHTML = '';
            
            Object.keys(Grupo).forEach(grupoKey => {
                const grupo = Grupo[grupoKey];
                container.innerHTML += `
                    <div class="col-md-3 mb-3">
                        <div class="card grupo-card" style="background-color: ${grupo.color}; border-left-color: ${this.oscurecerColor(grupo.color, 30)}">
                            <div class="card-body">
                                <h5 class="card-title">Grupo ${grupoKey}</h5>
                                <p class="card-text">${grupo.integrantes.replace(' - ', '<br>')}</p>
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        // Funci√≥n para oscurecer un color (para el borde)
        function oscurecerColor(color, cantidad) {
            // Eliminar el # si est√° presente
            color = color.replace('#', '');
            
            // Convertir a RGB
            let r = parseInt(color.substr(0, 2), 16);
            let g = parseInt(color.substr(2, 2), 16);
            let b = parseInt(color.substr(4, 2), 16);
            
            // Oscurecer
            r = Math.max(0, r - cantidad);
            g = Math.max(0, g - cantidad);
            b = Math.max(0, b - cantidad);
            
            // Volver a HEX
            return '#' + 
                   r.toString(16).padStart(2, '0') + 
                   g.toString(16).padStart(2, '0') + 
                   b.toString(16).padStart(2, '0');
        }

        // Actualizar la leyenda de grupos con colores din√°micos
        function actualizarLeyendaGrupos() {
            const leyendaContainer = document.getElementById('leyenda-grupos');
            let leyendaHTML = '<strong>Leyenda de Grupos:</strong> ';
            
            Object.keys(Grupo).forEach(grupoKey => {
                const grupo = Grupo[grupoKey];
                leyendaHTML += `
                    <span class="legend-item">
                        <span class="legend-color-dinamico" style="background-color: ${grupo.color}"></span>
                        Grupo ${grupoKey}
                    </span>
                `;
            });
            
            // Agregar el item "Libre" que siempre est√° presente
            leyendaHTML += `
                <span class="legend-item">
                    <span class="legend-color grupo-libre"></span>
                    Libre
                </span>
            `;
            
            leyendaContainer.innerHTML = leyendaHTML;
        }

        // Cargar todo al iniciar la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            cargarGruposGuardados();
            // Mostrar vista principal por defecto
            mostrarVistaPrincipal();
        });
		//****************************
		// Funci√≥n mejorada para aplicar colores din√°micos a la tabla
    function aplicarColoresDinamicosATabla() {
        console.log('Aplicando colores din√°micos a la tabla...');
        
        Object.keys(Grupo).forEach(grupoKey => {
            const grupo = Grupo[grupoKey];
            
            // Buscar celdas por clase CSS
            const celdasPorClase = document.querySelectorAll(`.${grupo.clase}`);
            celdasPorClase.forEach(celda => {
                celda.style.backgroundColor = grupo.color;
                celda.style.borderColor = oscurecerColor(grupo.color, 30);
                celda.style.color = '#000000';
                celda.style.fontWeight = 'bold';
            });
            
            // Tambi√©n buscar celdas que contengan el texto del grupo (por si las clases no se aplican)
            const celdasPorTexto = document.querySelectorAll('.celda-turno, .celda-turno-dia');
            celdasPorTexto.forEach(celda => {
                if (celda.textContent.trim() === grupoKey) {
                    celda.style.backgroundColor = grupo.color;
                    celda.style.borderColor = oscurecerColor(grupo.color, 30);
                    celda.style.color = '#000000';
                    celda.style.fontWeight = 'bold';
                }
            });
        });
        
        console.log('Colores aplicados a', document.querySelectorAll('[style*="background-color"]').length, 'celdas');
    }

    // Funci√≥n para forzar la actualizaci√≥n de colores (m√°s agresiva)
    function forzarActualizacionColores() {
        aplicarColoresDinamicosATabla();
        
        // Tambi√©n actualizar estilos CSS din√°micos
        actualizarEstilosGrupos();
        
        // Y actualizar la vista si es necesario
        if (typeof turnosSystem !== 'undefined' && typeof turnosSystem.generarTablaMesActual === 'function') {
            setTimeout(() => {
                turnosSystem.generarTablaMesActual();
                // Aplicar colores nuevamente despu√©s de regenerar
                setTimeout(aplicarColoresDinamicosATabla, 200);
            }, 100);
        }
    }

    // Modificar la funci√≥n guardarCambiosGrupos para forzar actualizaci√≥n
    function guardarCambiosGrupos() {
        try {
            localStorage.setItem('gruposConfig', JSON.stringify(Grupo));
            alert('‚úÖ Cambios guardados correctamente. Los grupos se mantendr√°n despu√©s de recargar la p√°gina.');
            console.log('Grupos guardados:', Grupo);
            
            actualizarInfoGrupos();
            actualizarLeyendaGrupos();
            actualizarEstilosGrupos();
            forzarActualizacionColores(); // <- Usar la funci√≥n mejorada
            
            // Volver a la vista principal
            setTimeout(() => {
                mostrarVistaPrincipal();
            }, 500);
            
        } catch (error) {
            alert('‚ùå Error al guardar los cambios: ' + error.message);
        }
    }

    // Interceptar la funci√≥n generarTabla del sistema de turnos
    if (typeof turnosSystem !== 'undefined') {
        // Guardar referencia a la funci√≥n original
        const generarTablaMesActualOriginal = turnosSystem.generarTablaMesActual;
        
        // Sobrescribir la funci√≥n
        turnosSystem.generarTablaMesActual = function() {
            // Llamar a la funci√≥n original
            if (generarTablaMesActualOriginal) {
                generarTablaMesActualOriginal.apply(this, arguments);
            }
            
            // Aplicar colores din√°micos despu√©s de que se genere la tabla
            setTimeout(() => {
                aplicarColoresDinamicosATabla();
            }, 150);
        };
    }

    // Tambi√©n interceptar window.generarTabla por si acaso
    const generarTablaOriginal = window.generarTabla;
    window.generarTabla = function() {
        if (generarTablaOriginal) {
            generarTablaOriginal();
        }
        setTimeout(aplicarColoresDinamicosATabla, 150);
    };

    // Aplicar colores cuando se carga la p√°gina
    document.addEventListener('DOMContentLoaded', function() {
        cargarGruposGuardados();
        mostrarVistaPrincipal();
        
        // Aplicar colores despu√©s de que todo est√© cargado
        setTimeout(() => {
            forzarActualizacionColores();
        }, 1000);
    });

    // Tambi√©n aplicar colores cuando se cambia de vista
    /*function cambiarVista() {
        // Llamar a la funci√≥n original si existe
        if (typeof window.cambiarVistaOriginal === 'function') {
            window.cambiarVistaOriginal();
        }
        
        // Aplicar colores despu√©s del cambio
        setTimeout(forzarActualizacionColores, 300);
    }

    // Guardar la funci√≥n original de cambiarVista si existe
    if (typeof window.cambiarVista === 'function' && window.cambiarVista !== cambiarVista) {
        window.cambiarVistaOriginal = window.cambiarVista;
        window.cambiarVista = cambiarVista;
    }*/
</script>

<script>
    // Funci√≥n mejorada para actualizar estilos CSS din√°micos
    function actualizarEstilosGrupos() {
        // Eliminar estilos anteriores si existen
        const estilosAnteriores = document.getElementById('estilos-dinamicos-grupos');
        if (estilosAnteriores) {
            estilosAnteriores.remove();
        }

        // Crear nuevos estilos
        const style = document.createElement('style');
        style.id = 'estilos-dinamicos-grupos';
        
        let css = '';
        
        // Generar CSS para cada grupo
        Object.keys(Grupo).forEach(grupoKey => {
            const grupo = Grupo[grupoKey];
            const colorOscuro = oscurecerColor(grupo.color, 30);
            
            css += `
                /* Estilos para la clase del grupo */
                .${grupo.clase} {
                    background-color: ${grupo.color} !important;
                    color: #000000 !important;
                    font-weight: bold !important;
                    border: 1px solid ${colorOscuro} !important;
                }
                
                /* Estilos espec√≠ficos para celdas de turnos */
                .celda-turno.${grupo.clase},
                .celda-turno-dia.${grupo.clase},
                .tabla-turnos .${grupo.clase},
                [class*="${grupo.clase}"] {
                    background-color: ${grupo.color} !important;
                    border-color: ${colorOscuro}

 !important;
                    color: #000000 !important;
                    font-weight: bold !important;
                }
                
                /* Estilos para la leyenda */
                .legend-color.${grupo.clase} {
                    background-color: ${grupo.color} !important;
                    border: 1px solid ${colorOscuro} !important;
                }
            `;
        });

        style.innerHTML = css;
        document.head.appendChild(style);
        console.log('Estilos CSS din√°micos actualizados');
    }


    </script>
	
	<script>
    // Sobreescribir la funci√≥n que asigna clases a las celdas de turnos (si es necesario)
    function asignarColorTurno(grupo) {
        if (Grupo[grupo]) {
            return Grupo[grupo].clase;
        }
        return 'grupo-libre'; // Para d√≠as libres
    }

    // Si necesitas modificar c√≥mo se generan las celdas en tu tabla:
    function generarCeldaTurno(dia, grupo) {
        const claseGrupo = asignarColorTurno(grupo);
        return `
            <div class="celda-turno ${claseGrupo}">
                ${grupo || ''}
            </div>
        `;
    }
</script>
</body>
</html>